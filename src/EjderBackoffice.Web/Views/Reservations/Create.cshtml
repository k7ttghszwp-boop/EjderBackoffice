@model Ejder.Core.Models.Reservation
@{
    var product = ViewBag.Product as Ejder.Core.Models.Product;
}

<h1>Rezervasyon Talebi</h1>

<form method="post">

    <input type="hidden" name="ProductId" value="@Model.ProductId" />
    <input type="hidden" name="TourName" value="@Model.TourName" />
    <input type="hidden" id="UnitPrice" value="@Model.UnitPrice" />

    <div class="form-group">
        <label>Tur</label>
        <input value="@Model.TourName" disabled />
    </div>

    <div class="form-group">
        <label>Tur Tarihi</label>
        <input type="date" name="TourDate"
               value="@Model.TourDate?.ToString("yyyy-MM-dd")"
               required />
    </div>

    <div class="form-group">
        <label>Kişi Sayısı</label>
        <input type="number" name="PersonCount"
               id="PersonCount"
               min="1" value="@Model.PersonCount" required />
    </div>

    <div class="form-group">
        <label>Ad Soyad</label>
        <input name="CustomerName" required />
    </div>

    <div class="form-group">
        <label>Telefon</label>
        <input name="Phone" required />
    </div>

    <div class="price-box">
        <span>Toplam Tutar:</span>
        <b id="TotalPrice">₺ @Model.UnitPrice?.ToString("N0")</b>
    </div>

    <button type="submit" class="btn primary">
        Talep Gönder
    </button>
</form>

<script>
    const unitPrice = parseFloat(document.getElementById("UnitPrice").value);
    const personInput = document.getElementById("PersonCount");
    const totalPriceEl = document.getElementById("TotalPrice");

    function updateTotal() {
        const count = parseInt(personInput.value || 1);
        const total = unitPrice * count;
        totalPriceEl.innerText = "₺ " + total.toLocaleString("tr-TR");
    }

    personInput.addEventListener("input", updateTotal);
    updateTotal();
</script>
